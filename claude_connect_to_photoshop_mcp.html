<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude DesktopとPhotoshopの接続設定方法</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.7;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background-color: #f8f9fa;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2d3748;
            border-bottom: 3px solid #4299e1;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #2d3748;
            margin-top: 35px;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 4px solid #4299e1;
        }
        h3 {
            color: #4a5568;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #4a5568;
            margin-top: 20px;
            margin-bottom: 12px;
        }
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.4;
            margin: 15px 0;
        }
        code {
            background: #e2e8f0;
            color: #2d3748;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 14px;
        }
        .note {
            background: #e6f3ff;
            border: 1px solid #4299e1;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .warning {
            background: #fff5f5;
            border: 1px solid #fc8181;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        ul, ol {
            padding-left: 25px;
        }
        li {
            margin-bottom: 8px;
        }
        a {
            color: #4299e1;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .system-flow {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            text-align: center;
        }
        .requirements {
            background: #fffaf0;
            border: 1px solid #fbd38d;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .requirements h3 {
            margin-top: 0;
            color: #9c4221;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Claude DesktopとPhotoshopの接続設定方法</h1>

    <h2>概要</h2>
    <p>MCPサーバーを使ってClaude DesktopからPhotoshopをテキスト入力で操作できるように設定する方法を説明します。</p>

    <h2>システム構成</h2>
    <div class="system-flow">
        Claude Desktop ↔ MCPサーバー ↔ プロキシサーバー ↔ PhotoshopUXPプラグイン ↔ Photoshop
    </div>

    <h2>必要な環境・ツール</h2>
    <div class="requirements">
        <ul>
            <li><strong>Claude Desktop</strong>（MacまたはWindows）</li>
            <li><strong>Python 3</strong>（MCPサーバーの実行用）</li>
            <li><strong>Node.js</strong>（プロキシサーバー用）</li>
            <li><strong>Adobe Photoshop</strong>（バージョン26.0以上）</li>
            <li><strong>Adobe UXP Developer Tools</strong>（Creative Cloud経由で利用可能）</li>
            <li><strong>プログラミング知識</strong>（基本的なターミナル操作）</li>
        </ul>
    </div>

    <h2>設定手順</h2>

    <h3>1. Claude Desktopのインストール</h3>
    <p>Claude.aiの公式サイトからデスクトップ版をダウンロードしてインストールします。</p>

    <h3>2. MCPプログラムの取得</h3>
    <p>GitHubから必要なプログラムをクローンします：</p>
    <pre><code>git clone https://github.com/mikechambers/adb-mcp.git</code></pre>

    <div class="warning">
        <strong>注意</strong>: このプロジェクトはAdobe公式ではなく、個人開発のプロジェクトです。
    </div>

    <h3>3. 必要なツールのインストール</h3>

    <h4>uvのインストール（macOSの場合）</h4>
    <pre><code>brew install uv</code></pre>

    <h4>MCPサーバーの起動</h4>
    <pre><code>cd adobe-mcp/mcp
uv run mcp dev ps-mcp.py</code></pre>

    <p>成功すると以下のメッセージが表示されます：</p>
    <pre><code>🔍 MCP Inspector is up and running at http://127.0.0.1:6274 🚀</code></pre>

    <h4>プロキシサーバーの起動</h4>
    <pre><code>cd adb-proxy-socket
npm install
npm install -g pkg
pkg .
node proxy.js</code></pre>

    <h3>4. Photoshopの設定変更</h3>
    <p>Photoshop内で以下の設定を有効にします：</p>
    <ol>
        <li><strong>環境設定</strong> → <strong>プラグイン</strong>を開く</li>
        <li>開発者向けオプションを有効化</li>
        <li>Photoshopを再起動</li>
    </ol>

    <h3>5. UXP Developer Toolsの設定</h3>

    <h4>インストールと有効化</h4>
    <ol>
        <li>Creative CloudからUXP Developer Toolsを検索</li>
        <li><strong>Enable</strong>をクリックしてインストール</li>
    </ol>

    <h4>プラグインの読み込み</h4>
    <ol>
        <li>UXP Developer Toolsを起動</li>
        <li><strong>Add Plugin</strong>から以下のファイルを選択：
            <pre><code>adb-mcp/uxp/ps/manifest.json</code></pre>
        </li>
        <li><strong>Load</strong>ボタンをクリック</li>
    </ol>

    <h4>Photoshopとの接続</h4>
    <ol>
        <li>Photoshop内にプラグインパネルが表示される</li>
        <li><strong>Connect</strong>ボタンをクリックして接続を確立</li>
    </ol>

    <h3>6. Claude Desktopの設定</h3>
    <p>Claude Desktopの設定ファイル（<code>claude_desktop_config.json</code>）に以下の設定を追加します：</p>

    <pre><code>{
  "mcpServers": {
    "blender": {
      "command": "uvx",
      "args": [
        "blender-mcp"
      ]
    },
    "Adobe Photoshop": {
      "command": "uv",
      "args": [
        "run",
        "python3",
        "/Users/[ユーザ名]/workspace/adb-mcp/mcp/ps-mcp.py"
      ]
    }
  }
}</code></pre>

    <div class="note">
        <strong>注意</strong>: パス <code>/Users/[ユーザ名]/workspace/adb-mcp/mcp/ps-mcp.py</code> の <code>[ユーザ名]</code> 部分を、実際のユーザ名に置き換え、プロジェクトをクローンした場所に合わせて変更してください。
    </div>

    <h3>7. Claude Desktopでの確認</h3>
    <p>設定後、Claude Desktopを再起動すると、MCPサーバーにPhotoshopが追加されていることが確認できます。</p>

    <h2>使用例</h2>
    <p>以下のようなプロンプトでPhotoshopを操作できます：</p>
    <pre><code>Create a new Photoshop file with a blue background, that is 1080 width by 720 height at 300 dpi</code></pre>
    <p>Claude Desktopが操作許可を求めるので、許可するとPhotoshopが自動的に指定された設定でファイルを作成します。</p>

    <h2>トラブルシューティング</h2>

    <h3>MCPサーバーに接続できない場合</h3>
    <p>MCPサーバーへの接続エラーが発生する場合は、以下の方法で解決できる場合があります：</p>
    <ol>
        <li><a href="https://github.com/mikechambers/adb-mcp/releases/" target="_blank">GitHubのReleasesページ</a>から <strong>photoshop-mcp.dxt</strong> をダウンロード</li>
        <li>ダウンロードした <strong>photoshop-mcp.dxt</strong> ファイルをダブルクリックで実行</li>
        <li>Claude Desktopを再起動して接続を確認</li>
    </ol>

    <h3>その他の接続問題</h3>

    <h4>接続できない場合</h4>
    <ol>
        <li>各サーバーが正常に起動しているか確認</li>
        <li>Photoshopの開発者設定が有効になっているか確認</li>
        <li>UXPプラグインが正しく読み込まれているか確認</li>
        <li>GitHubのREADMEを参照</li>
    </ol>

    <h3>ポート競合の場合</h3>
    <ul>
        <li>MCPサーバーやプロキシサーバーのポートが他のアプリケーションと競合していないか確認</li>
    </ul>

    <h2>注意事項</h2>
    <ul>
        <li>このプロジェクトはAdobe公式のサポートを受けていません</li>
        <li>個人開発プロジェクトのため、予期しない動作や互換性の問題が発生する可能性があります</li>
        <li>プログラミング知識が必要な設定作業が含まれています</li>
    </ul>

    <h2>参考リンク</h2>
    <ul>
        <li><a href="https://github.com/mikechambers/adb-mcp" target="_blank">adb-mcpプロジェクト</a></li>
        <li><a href="https://claude.ai" target="_blank">Claude Desktop</a></li>
        <li><a href="https://www.adobe.com/jp/creativecloud.html" target="_blank">Adobe Creative Cloud</a></li>
    </ul>
</div>
</body>
</html>